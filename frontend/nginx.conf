events {}

http {
  server {
    listen 8080;
    server_name _;

    root  /usr/share/nginx/html;
    index login.html;

    # Pretty URL: /login, /register, /dashboard
    location = /        { return 302 /login; }
    location = /login   { return 302 /login.html; }
    location = /register{ return 302 /register.html; }
    location = /dashboard{ return 302 /dashboard.html; }

    # File tĩnh còn lại
    location / {
      try_files $uri =404;
    }

    # ---- API proxy (http://api:8000) ----
    # KHÔNG thêm dấu / thừa hay thiếu để tránh 301/307
    location = /auth    { proxy_pass http://api:8000/auth; }
    location /auth/     { proxy_pass http://api:8000/auth/; }

    location = /news    { proxy_pass http://api:8000/news; }
    location /news/     { proxy_pass http://api:8000/news/; }

    location = /search  { proxy_pass http://api:8000/search; }
    location /search/   { proxy_pass http://api:8000/search/; }

    location = /health  { proxy_pass http://api:8000/health; }
    location /health/   { proxy_pass http://api:8000/health/; }
  }
}
